<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Guardado Local vs PHP - Visualizaci√≥n</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        header {
            background: linear-gradient(135deg, #205ca4 0%, #164273 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        header h1 { font-size: 32px; margin-bottom: 10px; }
        header p { font-size: 16px; opacity: 0.9; }
        
        .content { padding: 40px; }
        
        .diagram {
            background: #f8f9fa;
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 30px;
            margin: 30px 0;
        }
        
        .flow {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin: 30px 0;
        }
        
        .step {
            flex: 1;
            min-width: 200px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .step:hover { transform: translateY(-5px); }
        
        .step h3 { margin-bottom: 10px; }
        .step p { font-size: 14px; opacity: 0.9; }
        
        .arrow {
            font-size: 30px;
            color: #667eea;
            flex: 0;
        }
        
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 30px 0;
        }
        
        .comparison-item {
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid;
        }
        
        .before {
            background: #ffebee;
            border-color: #f44336;
        }
        
        .after {
            background: #e8f5e9;
            border-color: #4caf50;
        }
        
        .comparison-item h3 {
            margin-bottom: 15px;
            font-size: 18px;
        }
        
        .comparison-item ul {
            list-style: none;
            padding-left: 20px;
        }
        
        .comparison-item li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }
        
        .comparison-item li:last-child { border-bottom: none; }
        
        .before li:before { content: "‚ùå "; color: #f44336; }
        .after li:before { content: "‚úÖ "; color: #4caf50; }
        
        .storage {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 30px 0;
        }
        
        .storage-item {
            background: #f5f5f5;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #ddd;
        }
        
        .storage-item h3 {
            color: #205ca4;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .storage-item p {
            margin: 10px 0;
            font-size: 14px;
            color: #555;
        }
        
        .code {
            background: #222;
            color: #0f0;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            margin: 10px 0;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            border-bottom: 2px solid #ddd;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .tab-button {
            padding: 12px 20px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            color: #666;
            transition: all 0.3s ease;
        }
        
        .tab-button.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }
        
        .tab-button:hover { color: #667eea; }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .tab-content.active { display: block; }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .benefits {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .benefit-card {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e063 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .benefit-card h4 { margin-bottom: 10px; font-size: 16px; }
        .benefit-card p { font-size: 13px; opacity: 0.9; }
        
        .notes {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .notes h4 { color: #856404; margin-bottom: 10px; }
        .notes ul { margin-left: 20px; }
        .notes li { color: #856404; margin: 8px 0; }
        
        footer {
            background: #f5f5f5;
            padding: 20px;
            text-align: center;
            color: #666;
            border-top: 1px solid #ddd;
        }

        @media (max-width: 768px) {
            header h1 { font-size: 24px; }
            .comparison, .storage, .flow {
                grid-template-columns: 1fr;
            }
            .arrow { display: none; }
        }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>üöÄ Sistema de Guardado Local vs Env√≠o a PHP</h1>
        <p>Arquitectura mejorada con control del usuario</p>
    </header>

    <div class="content">

        <!-- FLUJO VISUAL -->
        <div class="diagram">
            <h2 style="text-align: center; color: #205ca4; margin-bottom: 30px;">üìä Flujo de Datos</h2>
            
            <div class="flow">
                <div class="step">
                    <h3>1Ô∏è‚É£</h3>
                    <p><strong>Llenar Formulario</strong></p>
                    <p style="font-size: 12px;">Ingresa los datos</p>
                </div>
                <div class="arrow">‚Üí</div>
                
                <div class="step">
                    <h3>2Ô∏è‚É£</h3>
                    <p><strong>Guardar Localmente</strong></p>
                    <p style="font-size: 12px;">localStorage</p>
                </div>
                <div class="arrow">‚Üí</div>
                
                <div class="step">
                    <h3>3Ô∏è‚É£</h3>
                    <p><strong>Revisar/Editar</strong></p>
                    <p style="font-size: 12px;">(Opcional)</p>
                </div>
                <div class="arrow">‚Üí</div>
                
                <div class="step">
                    <h3>4Ô∏è‚É£</h3>
                    <p><strong>Enviar a PHP</strong></p>
                    <p style="font-size: 12px;">SQL Server</p>
                </div>
            </div>
        </div>

        <!-- ANTES vs DESPU√âS -->
        <h2 style="color: #205ca4; margin: 40px 0 20px 0;">üîÑ Comparaci√≥n: Antes vs Despu√©s</h2>
        <div class="comparison">
            <div class="comparison-item before">
                <h3>‚ùå ANTES</h3>
                <ul>
                    <li>Click Guardar ‚Üí Autom√°ticamente env√≠a a PHP</li>
                    <li>Si falla env√≠o, se pierde el registro</li>
                    <li>No funciona sin internet</li>
                    <li>Usuario no controla cu√°ndo enviar</li>
                    <li>Confusi√≥n entre "guardado" y "enviado"</li>
                    <li>Una sola oportunidad de guardar</li>
                </ul>
            </div>

            <div class="comparison-item after">
                <h3>‚úÖ AHORA</h3>
                <ul>
                    <li>Click Guardar ‚Üí Se guarda en localStorage</li>
                    <li>Datos siempre disponibles en el navegador</li>
                    <li>Funciona sin conexi√≥n a internet</li>
                    <li>Usuario decide cu√°ndo enviar a PHP</li>
                    <li>Diferencia clara: local vs servidor</li>
                    <li>Puedes reintentar env√≠o m√∫ltiples veces</li>
                </ul>
            </div>
        </div>

        <!-- ALMACENAMIENTO -->
        <h2 style="color: #205ca4; margin: 40px 0 20px 0;">üíæ D√≥nde se Guardan los Datos</h2>
        <div class="storage">
            <div class="storage-item">
                <h3>üíª localStorage (Navegador)</h3>
                <p><strong>Cu√°ndo:</strong> Al hacer click "Guardar Localmente"</p>
                <p><strong>D√≥nde:</strong> Almacenamiento del navegador (tu computadora)</p>
                <p><strong>Duraci√≥n:</strong> Indefinida (hasta que limpies cach√©)</p>
                <p><strong>L√≠mite:</strong> ~5-10 MB por dominio</p>
                <div class="code">localStorage.getItem('ambulancia:5678')</div>
                <p><strong>Ventaja:</strong> Funciona sin internet</p>
            </div>

            <div class="storage-item">
                <h3>üóÑÔ∏è SQL Server (Base de Datos)</h3>
                <p><strong>Cu√°ndo:</strong> Al hacer click "Enviar a Base de Datos"</p>
                <p><strong>D√≥nde:</strong> Servidor remoto</p>
                <p><strong>Duraci√≥n:</strong> Permanente</p>
                <p><strong>L√≠mite:</strong> Ilimitado</p>
                <div class="code">INSERT INTO formatos_limpieza (...)</div>
                <p><strong>Ventaja:</strong> Datos respaldados en servidor</p>
            </div>
        </div>

        <!-- BENEFICIOS -->
        <h2 style="color: #205ca4; margin: 40px 0 20px 0;">üéØ Beneficios Principales</h2>
        <div class="benefits">
            <div class="benefit-card">
                <h4>üì± Sin Internet</h4>
                <p>Puedes guardar datos incluso sin conexi√≥n a internet</p>
            </div>

            <div class="benefit-card">
                <h4>‚ö° Respuesta R√°pida</h4>
                <p>El guardado es instant√°neo (no espera al servidor)</p>
            </div>

            <div class="benefit-card">
                <h4>üîÑ Reintentos</h4>
                <p>Si falla, puedes reintentar sin perder datos</p>
            </div>

            <div class="benefit-card">
                <h4>üëÅÔ∏è Vista Previa</h4>
                <p>Revisa los datos antes de enviar a la BD</p>
            </div>

            <div class="benefit-card">
                <h4>üéÆ Control Total</h4>
                <p>T√∫ decides cu√°ndo enviar a la base de datos</p>
            </div>

            <div class="benefit-card">
                <h4>üíæ Respaldo Local</h4>
                <p>Incluso si falla PHP, los datos est√°n en el navegador</p>
            </div>
        </div>

        <!-- CASOS DE USO -->
        <h2 style="color: #205ca4; margin: 40px 0 20px 0;">üìã Casos de Uso</h2>
        <div class="tabs">
            <button class="tab-button active" onclick="mostrarTab('caso1')">Caso 1: Sin Internet</button>
            <button class="tab-button" onclick="mostrarTab('caso2')">Caso 2: Edici√≥n Progresiva</button>
            <button class="tab-button" onclick="mostrarTab('caso3')">Caso 3: Revisi√≥n Previa</button>
        </div>

        <div id="caso1" class="tab-content active" style="background: #f0f7ff; padding: 20px; border-radius: 10px;">
            <h3>üì± Caso 1: Usuario en el Terreno (Sin Internet)</h3>
            <ol style="margin-left: 20px; line-height: 2;">
                <li><strong>Llenar formulario</strong> en la ambulancia</li>
                <li><strong>Click "Guardar Localmente"</strong> ‚úÖ Funciona sin internet</li>
                <li><strong>Guardar m√°s registros</strong> mientras est√©s en el terreno</li>
                <li><strong>Volver a base</strong> y conectarte a internet</li>
                <li><strong>Click "Enviar a Base de Datos"</strong> para cada registro</li>
                <li><strong>Listo</strong> Los datos est√°n en SQL Server</li>
            </ol>
        </div>

        <div id="caso2" class="tab-content" style="background: #f0f7ff; padding: 20px; border-radius: 10px;">
            <h3>‚úèÔ∏è Caso 2: Edici√≥n Progresiva en Oficina</h3>
            <ol style="margin-left: 20px; line-height: 2;">
                <li><strong>Abrir editar_limpieza.php</strong></li>
                <li><strong>Llenar Limpieza</strong> ‚Üí "Guardar Localmente"</li>
                <li><strong>Click Lista</strong> para ver otros registros</li>
                <li><strong>Editar siguiente</strong> ‚Üí "Guardar Localmente"</li>
                <li><strong>Repetir</strong> con todos los registros</li>
                <li><strong>Cuando termines todo</strong>, env√≠a a PHP con el bot√≥n</li>
            </ol>
        </div>

        <div id="caso3" class="tab-content" style="background: #f0f7ff; padding: 20px; border-radius: 10px;">
            <h3>üëÅÔ∏è Caso 3: Verificaci√≥n Antes de Enviar</h3>
            <ol style="margin-left: 20px; line-height: 2;">
                <li><strong>Llenar formulario</strong> con datos</li>
                <li><strong>Click "Guardar Localmente"</strong></li>
                <li><strong>Click "Imprimir/Vista Previa"</strong></li>
                <li><strong>Revisar</strong> los datos en el PDF</li>
                <li><strong>Si est√° bien:</strong> "Enviar a Base de Datos" ‚úÖ</li>
                <li><strong>Si hay errores:</strong> Editar y "Guardar Localmente" de nuevo</li>
            </ol>
        </div>

        <!-- NOTAS IMPORTANTES -->
        <div class="notes">
            <h4>‚ö†Ô∏è Cosas Importantes que Debes Saber</h4>
            <ul>
                <li><strong>localStorage tiene l√≠mite:</strong> ~5-10 MB por dominio. Si guardas muchos registros grandes, puede llenar. Soluci√≥n: Env√≠a a PHP regularmente.</li>
                <li><strong>Si limpias cach√©/cookies:</strong> Se pierden los datos no enviados. Por eso es importante enviar a PHP pronto.</li>
                <li><strong>El bot√≥n "Enviar a PHP" solo aparece despu√©s de "Guardar Localmente"</strong> para evitar errores.</li>
                <li><strong>Si falla el env√≠o a PHP:</strong> Los datos siguen en localStorage, puedes reintentar cuantas veces quieras.</li>
                <li><strong>localStorage es por navegador:</strong> Si abres desde Chrome, Edge o Firefox, tendr√°n datos diferentes.</li>
            </ul>
        </div>

        <!-- ARCHIVOS MODIFICADOS -->
        <h2 style="color: #205ca4; margin: 40px 0 20px 0;">üìù Archivos Modificados</h2>
        <div style="background: #f5f5f5; padding: 20px; border-radius: 10px;">
            <h4>‚úèÔ∏è editar_limpieza.php</h4>
            <p style="color: #666; margin: 10px 0;">Cambios en:</p>
            <ul style="margin-left: 20px; color: #666;">
                <li><strong>L√≠nea ~370:</strong> Botones ‚Üí "Guardar Localmente" + "Enviar a Base de Datos"</li>
                <li><strong>L√≠nea ~757:</strong> Guardado ‚Üí Sin env√≠o autom√°tico</li>
                <li><strong>L√≠nea ~997:</strong> Nueva funci√≥n <code>enviarAPhpManual()</code></li>
                <li><strong>L√≠nea ~1009:</strong> Nueva funci√≥n <code>mostrarEstadoSync()</code></li>
                <li><strong>L√≠nea ~1021:</strong> Actualizada funci√≥n <code>limpiarFormulario()</code></li>
            </ul>
            <p style="color: #666; margin: 15px 0;"><strong>‚úÖ Otros archivos sin cambios:</strong> insertar.php, actualizar_limpieza.php, conexion.php, etc.</p>
        </div>

        <!-- C√ìMO PROBAR -->
        <h2 style="color: #205ca4; margin: 40px 0 20px 0;">üß™ C√≥mo Probar el Sistema</h2>
        <div style="background: #f5f5f5; padding: 20px; border-radius: 10px;">
            <h4 style="color: #205ca4; margin-bottom: 15px;">Test 1: Guardar sin Internet</h4>
            <ol style="margin-left: 20px; color: #666; line-height: 1.8;">
                <li>Abre DevTools (<strong>F12</strong>)</li>
                <li>Ve a Network ‚Üí Pon en <strong>Offline</strong></li>
                <li>Llena el formulario</li>
                <li>Click <strong>"Guardar Localmente"</strong>
                    <ul style="margin: 10px 0 0 20px;">
                        <li>‚úÖ Debe aparecer alerta verde</li>
                        <li>‚úÖ Debe aparecer bot√≥n "Enviar a Base de Datos"</li>
                    </ul>
                </li>
                <li>Recarga la p√°gina (<strong>Ctrl+R</strong>)
                    <ul style="margin: 10px 0 0 20px;">
                        <li>‚úÖ Los datos deben seguir ah√≠</li>
                    </ul>
                </li>
            </ol>

            <h4 style="color: #205ca4; margin: 30px 0 15px 0;">Test 2: Enviar a PHP</h4>
            <ol style="margin-left: 20px; color: #666; line-height: 1.8;">
                <li>Pon DevTools en <strong>Online</strong></li>
                <li>Click <strong>"Enviar a Base de Datos"</strong>
                    <ul style="margin: 10px 0 0 20px;">
                        <li>‚úÖ Debe enviar a insertar.php o actualizar_limpieza.php</li>
                        <li>‚úÖ Debe mostrar alerta de confirmaci√≥n</li>
                        <li>‚úÖ El registro debe aparecer en ver_formatos.php</li>
                    </ul>
                </li>
            </ol>

            <h4 style="color: #205ca4; margin: 30px 0 15px 0;">Test 3: Ver localStorage</h4>
            <ol style="margin-left: 20px; color: #666; line-height: 1.8;">
                <li>DevTools (<strong>F12</strong>) ‚Üí Application ‚Üí Local Storage</li>
                <li>Busca claves que comiencen con <strong>"ambulancia:"</strong></li>
                <li>Click en una para ver el JSON
                    <ul style="margin: 10px 0 0 20px;">
                        <li>‚úÖ Deben estar todos los datos del formulario</li>
                    </ul>
                </li>
            </ol>
        </div>

    </div>

    <footer>
        <p>üìö Documentaci√≥n: ARQUITECTURA_GUARDADO_LOCAL.md | CAMBIOS_REALIZADOS.md</p>
        <p>¬© 2026 Sistema de Gesti√≥n de Ambulancias</p>
    </footer>
</div>

<script>
function mostrarTab(nombre) {
    // Ocultar todos los tabs
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.remove('active');
    });
    
    // Desactivar todos los botones
    document.querySelectorAll('.tab-button').forEach(btn => {
        btn.classList.remove('active');
    });
    
    // Mostrar tab seleccionado
    document.getElementById(nombre).classList.add('active');
    
    // Activar bot√≥n seleccionado
    event.target.classList.add('active');
}
</script>

</body>
</html>
